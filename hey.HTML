<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday, Devyanshi!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden; /* Prevent horizontal scroll */
            background-color: #fce4ec; /* Light pink background */
        }
        .font-pacifico {
            font-family: 'Pacifico', cursive;
        }
        .confetti {
            position: fixed; /* Use fixed to cover the viewport */
            width: 10px;
            height: 20px;
            background-color: #f06292; /* Pink */
            opacity: 0.7;
            animation: fall 10s linear infinite;
            z-index: 0;
        }
        .confetti:nth-child(2n) { background-color: #ffd54f; } /* Yellow */
        .confetti:nth-child(3n) { background-color: #4fc3f7; } /* Blue */
        .confetti:nth-child(4n) { background-color: #81c784; } /* Green */
        .confetti:nth-child(5n) { background-color: #ba68c8; } /* Purple */

        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg); }
            100% { transform: translateY(110vh) rotate(720deg); }
        }
        
        .card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            z-index: 10;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        /* Loading Spinner */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #ec4899;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Poem container styles */
        #poem-container {
            white-space: pre-wrap; /* Preserve line breaks in the poem */
            background-color: #fdf2f8;
            border-left: 4px solid #ec4899;
        }
    </style>
</head>
<body class="bg-pink-50">

    <!-- Confetti Container -->
    <div id="confetti-container" class="absolute inset-0"></div>

    <!-- Main Content -->
    <div class="relative min-h-screen flex flex-col items-center justify-center p-4">
        
        <div id="main-card" class="card w-full max-w-2xl rounded-2xl shadow-2xl p-6 md:p-10 text-center text-gray-700 mb-8">
            
            <!-- Header -->
            <h1 class="font-pacifico text-4xl md:text-6xl text-pink-500 drop-shadow-lg">Surprise!</h1>
            <h2 class="text-2xl md:text-4xl font-bold mt-2 text-gray-800">Happy Birthday, Devyanshi my Gadhi!</h2>
            <p class="mt-4 text-lg">Gotcha! Bet you didn't see this coming, did you? ðŸ˜‰</p>

            <hr class="my-6 border-pink-200">

            <!-- Personal Message -->
            <div class="text-left">
                <h3 class="font-bold text-xl text-pink-600">To the biggest, cutest, most lovable Gadhi in the entire universe,</h3>
                <p class="mt-2">
                    Today is all about YOU! It's the one day of the year we celebrate the amazing, chaotic, and wonderful existence that is Devyanshi. The world became a much brighter, funnier, and crazier place the day you were born, and my world definitely did the moment you stumbled into it.
                </p>
                <p class="mt-2">
                    You bring so much laughter with your silly antics and your infectious smile. Even when you're being a total "Gadhi," you're <span class="font-bold text-pink-500">my</span> favorite Gadhi, and I wouldn't have it any other way.
                </p>
            </div>

            <!-- Image Placeholder -->
            <div class="my-8">
                <img src="p1.jpg"
                     alt="A picture of Devyanshi" 
                     class="rounded-xl shadow-lg mx-auto w-full max-w-md"
                     onerror="this.onerror=null;this.src='https://placehold.co/600x400/f8bbd0/4a4a4a?text=Image+Not+Found';">
            </div>

            <!-- Reasons Why Section -->
            <div class="text-left">
                <h3 class="font-bold text-xl text-pink-600">A Few Reasons Why You're the Best:</h3>
                <ul class="list-disc list-inside mt-2 space-y-1">
                    <li><strong>Your Laughter:</strong> It's contagious and so childish which literally light up a room.</li>
                    <li><strong>Your Heart:</strong> It's made of pure gold` (even if you hide it under a layer of sarcasm).</li>
                    <li><strong>Your Support:</strong> You're always there, no matter what. A true partner-in-crime.</li>
                    <li><strong>Your Uniqueness/(myDefective):</strong> There's no one else quite like you who connects with me.</li>
                    <li><strong>Your "Gadhi-pan":</strong> Your special brand of silliness that makes every moment unforgettable.</li>
                </ul>
            </div>
            
             <hr class="my-6 border-pink-200">

            <!-- Wishes Section -->
            <div class="text-left">
                <h3 class="font-bold text-xl text-pink-600">My Wish for You Today:</h3>
                <p class="mt-2">
                    On your birthday, I wish you everything you've ever dreamed of and more. May your year ahead be filled with endless cake, perfect gifts, unstoppable happiness, and dazzling success. May you always stay the wonderfully weird and amazing person you are.
                </p>
            </div>
            
            <!-- Gemini API Feature -->
            <div class="mt-8 text-center">
                 <button id="generate-poem-btn" class="bg-pink-500 text-white font-bold py-3 px-6 rounded-full hover:bg-pink-600 transition-all duration-300 transform hover:scale-105 shadow-lg">
                    Generate Birthday Poem âœ¨
                </button>
                <div id="loader" class="loader hidden"></div>
                <div id="poem-container" class="mt-6 p-4 rounded-lg text-left hidden"></div>
                 <p id="error-message" class="text-red-500 mt-4 hidden"></p>
            </div>


            <!-- Final Message -->
            <div class="mt-8">
                <p class="text-2xl font-pacifico text-pink-500">With all my love and endless teasing,</p>
                <p class="text-xl font-semibold mt-2">[Your BestFrind AKðŸ˜Š]</p>
            </div>

        </div>
    </div>

    <script>
        // JavaScript to create and animate confetti
        document.addEventListener('DOMContentLoaded', () => {
            const confettiContainer = document.getElementById('confetti-container');
            if (confettiContainer) {
                const confettiCount = 100;
                for (let i = 0; i < confettiCount; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');
                    confetti.style.left = `${Math.random() * 100}vw`;
                    confetti.style.animationDuration = `${Math.random() * 5 + 5}s`;
                    confetti.style.animationDelay = `${Math.random() * 5}s`;
                    confettiContainer.appendChild(confetti);
                }
            }

            const generateBtn = document.getElementById('generate-poem-btn');
            const loader = document.getElementById('loader');
            const poemContainer = document.getElementById('poem-container');
            const errorMessage = document.getElementById('error-message');

            if (generateBtn) {
                generateBtn.addEventListener('click', async () => {
                    // Hide previous results and show loader
                    poemContainer.classList.add('hidden');
                    errorMessage.classList.add('hidden');
                    loader.classList.remove('hidden');
                    generateBtn.disabled = true;

                    const prompt = "Write a short, funny, and loving birthday poem for my friend named 'Devyanshi'. I affectionately call her 'Gadhi'. The poem should be light-hearted and celebrate her unique, silly personality.";
                    
                    try {
                        const poemText = await generateContentWithRetry(prompt);
                        poemContainer.textContent = poemText;
                        poemContainer.classList.remove('hidden');
                    } catch (error) {
                        console.error("Error generating poem:", error);
                        errorMessage.textContent = 'Oops! Could not write the poem right now. Please try again later.';
                        errorMessage.classList.remove('hidden');
                    } finally {
                        // Hide loader and re-enable button
                        loader.classList.add('hidden');
                        generateBtn.disabled = false;
                    }
                });
            }
        });

        // Function to call Gemini API with exponential backoff
        async function generateContentWithRetry(prompt, maxRetries = 3) {
            const apiKey = "AIzaSyAheZWxCu8GbA217i0ScdC_8mRNwSea7MQ"; // API key is handled by the environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            
            let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
            const payload = { contents: chatHistory };

            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API request failed with status ${response.status}`);
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error("Invalid response structure from API.");
                    }

                } catch (error) {
                    console.warn(`Attempt ${i + 1} failed. Retrying in ${Math.pow(2, i)}s...`);
                    if (i === maxRetries - 1) throw error;
                    await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
                }
            }
        }

    </script>

</body>
</html>
